Loading Demucs model for source separation...
Advanced Audio Analyzer initialized with Demucs BagOfModels(
  (models): ModuleList(
    (0-3): 4 x HTDemucs(
      (encoder): ModuleList(
        (0): HEncLayer(
          (conv): Conv2d(4, 48, kernel_size=(8, 1), stride=(4, 1), padding=(2, 0))
          (norm1): Identity()
          (rewrite): Conv2d(48, 96, kernel_size=(1, 1), stride=(1, 1))
          (norm2): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(48, 6, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 6, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(6, 96, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 96, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(48, 6, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 6, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(6, 96, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 96, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
        (1): HEncLayer(
          (conv): Conv2d(48, 96, kernel_size=(8, 1), stride=(4, 1), padding=(2, 0))
          (norm1): Identity()
          (rewrite): Conv2d(96, 192, kernel_size=(1, 1), stride=(1, 1))
          (norm2): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(96, 12, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 12, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(12, 192, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 192, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(96, 12, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 12, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(12, 192, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 192, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
        (2): HEncLayer(
          (conv): Conv2d(96, 192, kernel_size=(8, 1), stride=(4, 1), padding=(2, 0))
          (norm1): Identity()
          (rewrite): Conv2d(192, 384, kernel_size=(1, 1), stride=(1, 1))
          (norm2): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(192, 24, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 24, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(24, 384, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 384, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(192, 24, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 24, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(24, 384, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 384, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
        (3): HEncLayer(
          (conv): Conv2d(192, 384, kernel_size=(8, 1), stride=(4, 1), padding=(2, 0))
          (norm1): Identity()
          (rewrite): Conv2d(384, 768, kernel_size=(1, 1), stride=(1, 1))
          (norm2): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(384, 48, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 48, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(48, 768, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 768, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(384, 48, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 48, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(48, 768, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 768, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
      )
      (decoder): ModuleList(
        (0): HDecLayer(
          (conv_tr): ConvTranspose2d(384, 192, kernel_size=(8, 1), stride=(4, 1))
          (norm2): Identity()
          (rewrite): Conv2d(384, 768, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
          (norm1): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(384, 48, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 48, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(48, 768, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 768, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(384, 48, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 48, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(48, 768, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 768, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
        (1): HDecLayer(
          (conv_tr): ConvTranspose2d(192, 96, kernel_size=(8, 1), stride=(4, 1))
          (norm2): Identity()
          (rewrite): Conv2d(192, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
          (norm1): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(192, 24, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 24, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(24, 384, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 384, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(192, 24, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 24, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(24, 384, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 384, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
        (2): HDecLayer(
          (conv_tr): ConvTranspose2d(96, 48, kernel_size=(8, 1), stride=(4, 1))
          (norm2): Identity()
          (rewrite): Conv2d(96, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
          (norm1): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(96, 12, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 12, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(12, 192, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 192, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(96, 12, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 12, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(12, 192, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 192, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
        (3): HDecLayer(
          (conv_tr): ConvTranspose2d(48, 16, kernel_size=(8, 1), stride=(4, 1))
          (norm2): Identity()
          (rewrite): Conv2d(48, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
          (norm1): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(48, 6, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 6, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(6, 96, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 96, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(48, 6, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 6, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(6, 96, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 96, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
      )
      (tencoder): ModuleList(
        (0): HEncLayer(
          (conv): Conv1d(2, 48, kernel_size=(8,), stride=(4,), padding=(2,))
          (norm1): Identity()
          (rewrite): Conv1d(48, 96, kernel_size=(1,), stride=(1,))
          (norm2): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(48, 6, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 6, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(6, 96, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 96, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(48, 6, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 6, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(6, 96, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 96, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
        (1): HEncLayer(
          (conv): Conv1d(48, 96, kernel_size=(8,), stride=(4,), padding=(2,))
          (norm1): Identity()
          (rewrite): Conv1d(96, 192, kernel_size=(1,), stride=(1,))
          (norm2): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(96, 12, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 12, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(12, 192, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 192, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(96, 12, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 12, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(12, 192, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 192, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
        (2): HEncLayer(
          (conv): Conv1d(96, 192, kernel_size=(8,), stride=(4,), padding=(2,))
          (norm1): Identity()
          (rewrite): Conv1d(192, 384, kernel_size=(1,), stride=(1,))
          (norm2): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(192, 24, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 24, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(24, 384, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 384, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(192, 24, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 24, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(24, 384, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 384, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
        (3): HEncLayer(
          (conv): Conv1d(192, 384, kernel_size=(8,), stride=(4,), padding=(2,))
          (norm1): Identity()
          (rewrite): Conv1d(384, 768, kernel_size=(1,), stride=(1,))
          (norm2): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(384, 48, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 48, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(48, 768, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 768, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(384, 48, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 48, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(48, 768, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 768, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
      )
      (tdecoder): ModuleList(
        (0): HDecLayer(
          (conv_tr): ConvTranspose1d(384, 192, kernel_size=(8,), stride=(4,))
          (norm2): Identity()
          (rewrite): Conv1d(384, 768, kernel_size=(3,), stride=(1,), padding=(1,))
          (norm1): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(384, 48, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 48, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(48, 768, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 768, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(384, 48, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 48, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(48, 768, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 768, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
        (1): HDecLayer(
          (conv_tr): ConvTranspose1d(192, 96, kernel_size=(8,), stride=(4,))
          (norm2): Identity()
          (rewrite): Conv1d(192, 384, kernel_size=(3,), stride=(1,), padding=(1,))
          (norm1): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(192, 24, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 24, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(24, 384, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 384, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(192, 24, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 24, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(24, 384, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 384, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
        (2): HDecLayer(
          (conv_tr): ConvTranspose1d(96, 48, kernel_size=(8,), stride=(4,))
          (norm2): Identity()
          (rewrite): Conv1d(96, 192, kernel_size=(3,), stride=(1,), padding=(1,))
          (norm1): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(96, 12, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 12, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(12, 192, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 192, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(96, 12, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 12, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(12, 192, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 192, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
        (3): HDecLayer(
          (conv_tr): ConvTranspose1d(48, 8, kernel_size=(8,), stride=(4,))
          (norm2): Identity()
          (rewrite): Conv1d(48, 96, kernel_size=(3,), stride=(1,), padding=(1,))
          (norm1): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(48, 6, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 6, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(6, 96, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 96, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(48, 6, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 6, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(6, 96, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 96, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
      )
      (freq_emb): ScaledEmbedding(
        (embedding): Embedding(512, 48)
      )
      (channel_upsampler): Conv1d(384, 512, kernel_size=(1,), stride=(1,))
      (channel_downsampler): Conv1d(512, 384, kernel_size=(1,), stride=(1,))
      (channel_upsampler_t): Conv1d(384, 512, kernel_size=(1,), stride=(1,))
      (channel_downsampler_t): Conv1d(512, 384, kernel_size=(1,), stride=(1,))
      (crosstransformer): CrossTransformerEncoder(
        (norm_in): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (norm_in_t): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (layers): ModuleList(
          (0): MyTransformerEncoderLayer(
            (self_attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
            )
            (linear1): Linear(in_features=512, out_features=2048, bias=True)
            (dropout): Dropout(p=0.02, inplace=False)
            (linear2): Linear(in_features=2048, out_features=512, bias=True)
            (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (dropout1): Dropout(p=0.02, inplace=False)
            (dropout2): Dropout(p=0.02, inplace=False)
            (norm_out): MyGroupNorm(1, 512, eps=1e-05, affine=True)
            (gamma_1): LayerScale()
            (gamma_2): LayerScale()
          )
          (1): CrossTransformerEncoderLayer(
            (cross_attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
            )
            (linear1): Linear(in_features=512, out_features=2048, bias=True)
            (dropout): Dropout(p=0.02, inplace=False)
            (linear2): Linear(in_features=2048, out_features=512, bias=True)
            (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm3): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm_out): MyGroupNorm(1, 512, eps=1e-05, affine=True)
            (gamma_1): LayerScale()
            (gamma_2): LayerScale()
            (dropout1): Dropout(p=0.02, inplace=False)
            (dropout2): Dropout(p=0.02, inplace=False)
          )
          (2): MyTransformerEncoderLayer(
            (self_attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
            )
            (linear1): Linear(in_features=512, out_features=2048, bias=True)
            (dropout): Dropout(p=0.02, inplace=False)
            (linear2): Linear(in_features=2048, out_features=512, bias=True)
            (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (dropout1): Dropout(p=0.02, inplace=False)
            (dropout2): Dropout(p=0.02, inplace=False)
            (norm_out): MyGroupNorm(1, 512, eps=1e-05, affine=True)
            (gamma_1): LayerScale()
            (gamma_2): LayerScale()
          )
          (3): CrossTransformerEncoderLayer(
            (cross_attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
            )
            (linear1): Linear(in_features=512, out_features=2048, bias=True)
            (dropout): Dropout(p=0.02, inplace=False)
            (linear2): Linear(in_features=2048, out_features=512, bias=True)
            (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm3): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm_out): MyGroupNorm(1, 512, eps=1e-05, affine=True)
            (gamma_1): LayerScale()
            (gamma_2): LayerScale()
            (dropout1): Dropout(p=0.02, inplace=False)
            (dropout2): Dropout(p=0.02, inplace=False)
          )
          (4): MyTransformerEncoderLayer(
            (self_attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
            )
            (linear1): Linear(in_features=512, out_features=2048, bias=True)
            (dropout): Dropout(p=0.02, inplace=False)
            (linear2): Linear(in_features=2048, out_features=512, bias=True)
            (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (dropout1): Dropout(p=0.02, inplace=False)
            (dropout2): Dropout(p=0.02, inplace=False)
            (norm_out): MyGroupNorm(1, 512, eps=1e-05, affine=True)
            (gamma_1): LayerScale()
            (gamma_2): LayerScale()
          )
        )
        (layers_t): ModuleList(
          (0): MyTransformerEncoderLayer(
            (self_attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
            )
            (linear1): Linear(in_features=512, out_features=2048, bias=True)
            (dropout): Dropout(p=0.02, inplace=False)
            (linear2): Linear(in_features=2048, out_features=512, bias=True)
            (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (dropout1): Dropout(p=0.02, inplace=False)
            (dropout2): Dropout(p=0.02, inplace=False)
            (norm_out): MyGroupNorm(1, 512, eps=1e-05, affine=True)
            (gamma_1): LayerScale()
            (gamma_2): LayerScale()
          )
          (1): CrossTransformerEncoderLayer(
            (cross_attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
            )
            (linear1): Linear(in_features=512, out_features=2048, bias=True)
            (dropout): Dropout(p=0.02, inplace=False)
            (linear2): Linear(in_features=2048, out_features=512, bias=True)
            (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm3): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm_out): MyGroupNorm(1, 512, eps=1e-05, affine=True)
            (gamma_1): LayerScale()
            (gamma_2): LayerScale()
            (dropout1): Dropout(p=0.02, inplace=False)
            (dropout2): Dropout(p=0.02, inplace=False)
          )
          (2): MyTransformerEncoderLayer(
            (self_attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
            )
            (linear1): Linear(in_features=512, out_features=2048, bias=True)
            (dropout): Dropout(p=0.02, inplace=False)
            (linear2): Linear(in_features=2048, out_features=512, bias=True)
            (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (dropout1): Dropout(p=0.02, inplace=False)
            (dropout2): Dropout(p=0.02, inplace=False)
            (norm_out): MyGroupNorm(1, 512, eps=1e-05, affine=True)
            (gamma_1): LayerScale()
            (gamma_2): LayerScale()
          )
          (3): CrossTransformerEncoderLayer(
            (cross_attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
            )
            (linear1): Linear(in_features=512, out_features=2048, bias=True)
            (dropout): Dropout(p=0.02, inplace=False)
            (linear2): Linear(in_features=2048, out_features=512, bias=True)
            (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm3): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm_out): MyGroupNorm(1, 512, eps=1e-05, affine=True)
            (gamma_1): LayerScale()
            (gamma_2): LayerScale()
            (dropout1): Dropout(p=0.02, inplace=False)
            (dropout2): Dropout(p=0.02, inplace=False)
          )
          (4): MyTransformerEncoderLayer(
            (self_attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
            )
            (linear1): Linear(in_features=512, out_features=2048, bias=True)
            (dropout): Dropout(p=0.02, inplace=False)
            (linear2): Linear(in_features=2048, out_features=512, bias=True)
            (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (dropout1): Dropout(p=0.02, inplace=False)
            (dropout2): Dropout(p=0.02, inplace=False)
            (norm_out): MyGroupNorm(1, 512, eps=1e-05, affine=True)
            (gamma_1): LayerScale()
            (gamma_2): LayerScale()
          )
        )
      )
    )
  )
)
✅ Advanced Audio Analyzer initialized successfully
🚀 Starting ADVANCED 8-bit Music Analyzer API...
🎛️ Features: Demucs source separation + lead stem selection
   Advanced analyzer loaded: AdvancedAudioAnalyzer
   Demucs model: BagOfModels
   Supported frequencies: 24
   Pentatonic frequencies: 13
   Supported formats: wav, ogg, flac, m4a, mp3, aac
   Max file size: 16MB

Available endpoints:
  POST /analyze - Advanced audio analysis with Demucs
  GET /info - Service information
  GET /progress - Progress tracking info
  GET /health - Health check

Starting server on http://localhost:5001
 * Serving Flask app 'advanced_api'
 * Debug mode: on
WARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5001
 * Running on http://172.18.199.126:5001
Press CTRL+C to quit
 * Restarting with stat
Loading Demucs model for source separation...
Advanced Audio Analyzer initialized with Demucs BagOfModels(
  (models): ModuleList(
    (0-3): 4 x HTDemucs(
      (encoder): ModuleList(
        (0): HEncLayer(
          (conv): Conv2d(4, 48, kernel_size=(8, 1), stride=(4, 1), padding=(2, 0))
          (norm1): Identity()
          (rewrite): Conv2d(48, 96, kernel_size=(1, 1), stride=(1, 1))
          (norm2): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(48, 6, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 6, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(6, 96, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 96, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(48, 6, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 6, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(6, 96, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 96, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
        (1): HEncLayer(
          (conv): Conv2d(48, 96, kernel_size=(8, 1), stride=(4, 1), padding=(2, 0))
          (norm1): Identity()
          (rewrite): Conv2d(96, 192, kernel_size=(1, 1), stride=(1, 1))
          (norm2): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(96, 12, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 12, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(12, 192, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 192, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(96, 12, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 12, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(12, 192, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 192, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
        (2): HEncLayer(
          (conv): Conv2d(96, 192, kernel_size=(8, 1), stride=(4, 1), padding=(2, 0))
          (norm1): Identity()
          (rewrite): Conv2d(192, 384, kernel_size=(1, 1), stride=(1, 1))
          (norm2): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(192, 24, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 24, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(24, 384, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 384, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(192, 24, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 24, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(24, 384, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 384, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
        (3): HEncLayer(
          (conv): Conv2d(192, 384, kernel_size=(8, 1), stride=(4, 1), padding=(2, 0))
          (norm1): Identity()
          (rewrite): Conv2d(384, 768, kernel_size=(1, 1), stride=(1, 1))
          (norm2): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(384, 48, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 48, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(48, 768, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 768, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(384, 48, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 48, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(48, 768, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 768, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
      )
      (decoder): ModuleList(
        (0): HDecLayer(
          (conv_tr): ConvTranspose2d(384, 192, kernel_size=(8, 1), stride=(4, 1))
          (norm2): Identity()
          (rewrite): Conv2d(384, 768, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
          (norm1): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(384, 48, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 48, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(48, 768, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 768, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(384, 48, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 48, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(48, 768, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 768, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
        (1): HDecLayer(
          (conv_tr): ConvTranspose2d(192, 96, kernel_size=(8, 1), stride=(4, 1))
          (norm2): Identity()
          (rewrite): Conv2d(192, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
          (norm1): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(192, 24, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 24, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(24, 384, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 384, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(192, 24, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 24, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(24, 384, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 384, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
        (2): HDecLayer(
          (conv_tr): ConvTranspose2d(96, 48, kernel_size=(8, 1), stride=(4, 1))
          (norm2): Identity()
          (rewrite): Conv2d(96, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
          (norm1): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(96, 12, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 12, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(12, 192, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 192, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(96, 12, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 12, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(12, 192, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 192, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
        (3): HDecLayer(
          (conv_tr): ConvTranspose2d(48, 16, kernel_size=(8, 1), stride=(4, 1))
          (norm2): Identity()
          (rewrite): Conv2d(48, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
          (norm1): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(48, 6, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 6, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(6, 96, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 96, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(48, 6, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 6, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(6, 96, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 96, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
      )
      (tencoder): ModuleList(
        (0): HEncLayer(
          (conv): Conv1d(2, 48, kernel_size=(8,), stride=(4,), padding=(2,))
          (norm1): Identity()
          (rewrite): Conv1d(48, 96, kernel_size=(1,), stride=(1,))
          (norm2): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(48, 6, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 6, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(6, 96, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 96, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(48, 6, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 6, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(6, 96, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 96, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
        (1): HEncLayer(
          (conv): Conv1d(48, 96, kernel_size=(8,), stride=(4,), padding=(2,))
          (norm1): Identity()
          (rewrite): Conv1d(96, 192, kernel_size=(1,), stride=(1,))
          (norm2): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(96, 12, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 12, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(12, 192, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 192, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(96, 12, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 12, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(12, 192, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 192, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
        (2): HEncLayer(
          (conv): Conv1d(96, 192, kernel_size=(8,), stride=(4,), padding=(2,))
          (norm1): Identity()
          (rewrite): Conv1d(192, 384, kernel_size=(1,), stride=(1,))
          (norm2): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(192, 24, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 24, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(24, 384, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 384, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(192, 24, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 24, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(24, 384, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 384, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
        (3): HEncLayer(
          (conv): Conv1d(192, 384, kernel_size=(8,), stride=(4,), padding=(2,))
          (norm1): Identity()
          (rewrite): Conv1d(384, 768, kernel_size=(1,), stride=(1,))
          (norm2): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(384, 48, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 48, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(48, 768, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 768, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(384, 48, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 48, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(48, 768, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 768, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
      )
      (tdecoder): ModuleList(
        (0): HDecLayer(
          (conv_tr): ConvTranspose1d(384, 192, kernel_size=(8,), stride=(4,))
          (norm2): Identity()
          (rewrite): Conv1d(384, 768, kernel_size=(3,), stride=(1,), padding=(1,))
          (norm1): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(384, 48, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 48, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(48, 768, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 768, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(384, 48, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 48, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(48, 768, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 768, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
        (1): HDecLayer(
          (conv_tr): ConvTranspose1d(192, 96, kernel_size=(8,), stride=(4,))
          (norm2): Identity()
          (rewrite): Conv1d(192, 384, kernel_size=(3,), stride=(1,), padding=(1,))
          (norm1): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(192, 24, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 24, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(24, 384, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 384, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(192, 24, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 24, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(24, 384, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 384, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
        (2): HDecLayer(
          (conv_tr): ConvTranspose1d(96, 48, kernel_size=(8,), stride=(4,))
          (norm2): Identity()
          (rewrite): Conv1d(96, 192, kernel_size=(3,), stride=(1,), padding=(1,))
          (norm1): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(96, 12, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 12, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(12, 192, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 192, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(96, 12, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 12, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(12, 192, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 192, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
        (3): HDecLayer(
          (conv_tr): ConvTranspose1d(48, 8, kernel_size=(8,), stride=(4,))
          (norm2): Identity()
          (rewrite): Conv1d(48, 96, kernel_size=(3,), stride=(1,), padding=(1,))
          (norm1): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(48, 6, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 6, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(6, 96, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 96, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(48, 6, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 6, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(6, 96, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 96, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
      )
      (freq_emb): ScaledEmbedding(
        (embedding): Embedding(512, 48)
      )
      (channel_upsampler): Conv1d(384, 512, kernel_size=(1,), stride=(1,))
      (channel_downsampler): Conv1d(512, 384, kernel_size=(1,), stride=(1,))
      (channel_upsampler_t): Conv1d(384, 512, kernel_size=(1,), stride=(1,))
      (channel_downsampler_t): Conv1d(512, 384, kernel_size=(1,), stride=(1,))
      (crosstransformer): CrossTransformerEncoder(
        (norm_in): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (norm_in_t): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (layers): ModuleList(
          (0): MyTransformerEncoderLayer(
            (self_attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
            )
            (linear1): Linear(in_features=512, out_features=2048, bias=True)
            (dropout): Dropout(p=0.02, inplace=False)
            (linear2): Linear(in_features=2048, out_features=512, bias=True)
            (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (dropout1): Dropout(p=0.02, inplace=False)
            (dropout2): Dropout(p=0.02, inplace=False)
            (norm_out): MyGroupNorm(1, 512, eps=1e-05, affine=True)
            (gamma_1): LayerScale()
            (gamma_2): LayerScale()
          )
          (1): CrossTransformerEncoderLayer(
            (cross_attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
            )
            (linear1): Linear(in_features=512, out_features=2048, bias=True)
            (dropout): Dropout(p=0.02, inplace=False)
            (linear2): Linear(in_features=2048, out_features=512, bias=True)
            (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm3): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm_out): MyGroupNorm(1, 512, eps=1e-05, affine=True)
            (gamma_1): LayerScale()
            (gamma_2): LayerScale()
            (dropout1): Dropout(p=0.02, inplace=False)
            (dropout2): Dropout(p=0.02, inplace=False)
          )
          (2): MyTransformerEncoderLayer(
            (self_attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
            )
            (linear1): Linear(in_features=512, out_features=2048, bias=True)
            (dropout): Dropout(p=0.02, inplace=False)
            (linear2): Linear(in_features=2048, out_features=512, bias=True)
            (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (dropout1): Dropout(p=0.02, inplace=False)
            (dropout2): Dropout(p=0.02, inplace=False)
            (norm_out): MyGroupNorm(1, 512, eps=1e-05, affine=True)
            (gamma_1): LayerScale()
            (gamma_2): LayerScale()
          )
          (3): CrossTransformerEncoderLayer(
            (cross_attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
            )
            (linear1): Linear(in_features=512, out_features=2048, bias=True)
            (dropout): Dropout(p=0.02, inplace=False)
            (linear2): Linear(in_features=2048, out_features=512, bias=True)
            (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm3): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm_out): MyGroupNorm(1, 512, eps=1e-05, affine=True)
            (gamma_1): LayerScale()
            (gamma_2): LayerScale()
            (dropout1): Dropout(p=0.02, inplace=False)
            (dropout2): Dropout(p=0.02, inplace=False)
          )
          (4): MyTransformerEncoderLayer(
            (self_attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
            )
            (linear1): Linear(in_features=512, out_features=2048, bias=True)
            (dropout): Dropout(p=0.02, inplace=False)
            (linear2): Linear(in_features=2048, out_features=512, bias=True)
            (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (dropout1): Dropout(p=0.02, inplace=False)
            (dropout2): Dropout(p=0.02, inplace=False)
            (norm_out): MyGroupNorm(1, 512, eps=1e-05, affine=True)
            (gamma_1): LayerScale()
            (gamma_2): LayerScale()
          )
        )
        (layers_t): ModuleList(
          (0): MyTransformerEncoderLayer(
            (self_attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
            )
            (linear1): Linear(in_features=512, out_features=2048, bias=True)
            (dropout): Dropout(p=0.02, inplace=False)
            (linear2): Linear(in_features=2048, out_features=512, bias=True)
            (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (dropout1): Dropout(p=0.02, inplace=False)
            (dropout2): Dropout(p=0.02, inplace=False)
            (norm_out): MyGroupNorm(1, 512, eps=1e-05, affine=True)
            (gamma_1): LayerScale()
            (gamma_2): LayerScale()
          )
          (1): CrossTransformerEncoderLayer(
            (cross_attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
            )
            (linear1): Linear(in_features=512, out_features=2048, bias=True)
            (dropout): Dropout(p=0.02, inplace=False)
            (linear2): Linear(in_features=2048, out_features=512, bias=True)
            (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm3): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm_out): MyGroupNorm(1, 512, eps=1e-05, affine=True)
            (gamma_1): LayerScale()
            (gamma_2): LayerScale()
            (dropout1): Dropout(p=0.02, inplace=False)
            (dropout2): Dropout(p=0.02, inplace=False)
          )
          (2): MyTransformerEncoderLayer(
            (self_attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
            )
            (linear1): Linear(in_features=512, out_features=2048, bias=True)
            (dropout): Dropout(p=0.02, inplace=False)
            (linear2): Linear(in_features=2048, out_features=512, bias=True)
            (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (dropout1): Dropout(p=0.02, inplace=False)
            (dropout2): Dropout(p=0.02, inplace=False)
            (norm_out): MyGroupNorm(1, 512, eps=1e-05, affine=True)
            (gamma_1): LayerScale()
            (gamma_2): LayerScale()
          )
          (3): CrossTransformerEncoderLayer(
            (cross_attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
            )
            (linear1): Linear(in_features=512, out_features=2048, bias=True)
            (dropout): Dropout(p=0.02, inplace=False)
            (linear2): Linear(in_features=2048, out_features=512, bias=True)
            (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm3): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm_out): MyGroupNorm(1, 512, eps=1e-05, affine=True)
            (gamma_1): LayerScale()
            (gamma_2): LayerScale()
            (dropout1): Dropout(p=0.02, inplace=False)
            (dropout2): Dropout(p=0.02, inplace=False)
          )
          (4): MyTransformerEncoderLayer(
            (self_attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
            )
            (linear1): Linear(in_features=512, out_features=2048, bias=True)
            (dropout): Dropout(p=0.02, inplace=False)
            (linear2): Linear(in_features=2048, out_features=512, bias=True)
            (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (dropout1): Dropout(p=0.02, inplace=False)
            (dropout2): Dropout(p=0.02, inplace=False)
            (norm_out): MyGroupNorm(1, 512, eps=1e-05, affine=True)
            (gamma_1): LayerScale()
            (gamma_2): LayerScale()
          )
        )
      )
    )
  )
) * Debugger is active!
 * Debugger PIN: 129-088-411
127.0.0.1 - - [09/Jul/2025 22:47:54] "GET /health HTTP/1.1" 200 -
127.0.0.1 - - [09/Jul/2025 22:48:02] "GET /progress/test-job-id HTTP/1.1" 200 -
127.0.0.1 - - [09/Jul/2025 22:48:09] "GET /progress/test-job-id HTTP/1.1" 200 -
 * Detected change in '/home/tong/apps/8_bit_music/advanced_api.py', reloading

✅ Advanced Audio Analyzer initialized successfully
🚀 Starting ADVANCED 8-bit Music Analyzer API...
🎛️ Features: Demucs source separation + lead stem selection
   Advanced analyzer loaded: AdvancedAudioAnalyzer
   Demucs model: BagOfModels
   Supported frequencies: 24
   Pentatonic frequencies: 13
   Supported formats: aac, mp3, m4a, wav, flac, ogg
   Max file size: 16MB

Available endpoints:
  POST /analyze - Advanced audio analysis with Demucs
  GET /info - Service information
  GET /progress - Progress tracking info
  GET /health - Health check

Starting server on http://localhost:5001
 * Restarting with stat
Loading Demucs model for source separation...
Advanced Audio Analyzer initialized with Demucs BagOfModels(
  (models): ModuleList(
    (0-3): 4 x HTDemucs(
      (encoder): ModuleList(
        (0): HEncLayer(
          (conv): Conv2d(4, 48, kernel_size=(8, 1), stride=(4, 1), padding=(2, 0))
          (norm1): Identity()
          (rewrite): Conv2d(48, 96, kernel_size=(1, 1), stride=(1, 1))
          (norm2): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(48, 6, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 6, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(6, 96, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 96, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(48, 6, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 6, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(6, 96, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 96, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
        (1): HEncLayer(
          (conv): Conv2d(48, 96, kernel_size=(8, 1), stride=(4, 1), padding=(2, 0))
          (norm1): Identity()
          (rewrite): Conv2d(96, 192, kernel_size=(1, 1), stride=(1, 1))
          (norm2): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(96, 12, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 12, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(12, 192, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 192, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(96, 12, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 12, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(12, 192, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 192, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
        (2): HEncLayer(
          (conv): Conv2d(96, 192, kernel_size=(8, 1), stride=(4, 1), padding=(2, 0))
          (norm1): Identity()
          (rewrite): Conv2d(192, 384, kernel_size=(1, 1), stride=(1, 1))
          (norm2): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(192, 24, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 24, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(24, 384, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 384, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(192, 24, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 24, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(24, 384, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 384, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
        (3): HEncLayer(
          (conv): Conv2d(192, 384, kernel_size=(8, 1), stride=(4, 1), padding=(2, 0))
          (norm1): Identity()
          (rewrite): Conv2d(384, 768, kernel_size=(1, 1), stride=(1, 1))
          (norm2): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(384, 48, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 48, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(48, 768, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 768, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(384, 48, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 48, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(48, 768, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 768, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
      )
      (decoder): ModuleList(
        (0): HDecLayer(
          (conv_tr): ConvTranspose2d(384, 192, kernel_size=(8, 1), stride=(4, 1))
          (norm2): Identity()
          (rewrite): Conv2d(384, 768, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
          (norm1): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(384, 48, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 48, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(48, 768, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 768, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(384, 48, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 48, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(48, 768, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 768, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
        (1): HDecLayer(
          (conv_tr): ConvTranspose2d(192, 96, kernel_size=(8, 1), stride=(4, 1))
          (norm2): Identity()
          (rewrite): Conv2d(192, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
          (norm1): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(192, 24, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 24, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(24, 384, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 384, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(192, 24, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 24, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(24, 384, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 384, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
        (2): HDecLayer(
          (conv_tr): ConvTranspose2d(96, 48, kernel_size=(8, 1), stride=(4, 1))
          (norm2): Identity()
          (rewrite): Conv2d(96, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
          (norm1): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(96, 12, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 12, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(12, 192, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 192, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(96, 12, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 12, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(12, 192, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 192, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
        (3): HDecLayer(
          (conv_tr): ConvTranspose2d(48, 16, kernel_size=(8, 1), stride=(4, 1))
          (norm2): Identity()
          (rewrite): Conv2d(48, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
          (norm1): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(48, 6, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 6, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(6, 96, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 96, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(48, 6, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 6, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(6, 96, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 96, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
      )
      (tencoder): ModuleList(
        (0): HEncLayer(
          (conv): Conv1d(2, 48, kernel_size=(8,), stride=(4,), padding=(2,))
          (norm1): Identity()
          (rewrite): Conv1d(48, 96, kernel_size=(1,), stride=(1,))
          (norm2): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(48, 6, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 6, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(6, 96, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 96, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(48, 6, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 6, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(6, 96, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 96, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
        (1): HEncLayer(
          (conv): Conv1d(48, 96, kernel_size=(8,), stride=(4,), padding=(2,))
          (norm1): Identity()
          (rewrite): Conv1d(96, 192, kernel_size=(1,), stride=(1,))
          (norm2): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(96, 12, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 12, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(12, 192, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 192, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(96, 12, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 12, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(12, 192, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 192, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
        (2): HEncLayer(
          (conv): Conv1d(96, 192, kernel_size=(8,), stride=(4,), padding=(2,))
          (norm1): Identity()
          (rewrite): Conv1d(192, 384, kernel_size=(1,), stride=(1,))
          (norm2): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(192, 24, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 24, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(24, 384, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 384, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(192, 24, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 24, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(24, 384, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 384, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
        (3): HEncLayer(
          (conv): Conv1d(192, 384, kernel_size=(8,), stride=(4,), padding=(2,))
          (norm1): Identity()
          (rewrite): Conv1d(384, 768, kernel_size=(1,), stride=(1,))
          (norm2): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(384, 48, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 48, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(48, 768, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 768, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(384, 48, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 48, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(48, 768, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 768, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
      )
      (tdecoder): ModuleList(
        (0): HDecLayer(
          (conv_tr): ConvTranspose1d(384, 192, kernel_size=(8,), stride=(4,))
          (norm2): Identity()
          (rewrite): Conv1d(384, 768, kernel_size=(3,), stride=(1,), padding=(1,))
          (norm1): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(384, 48, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 48, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(48, 768, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 768, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(384, 48, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 48, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(48, 768, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 768, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
        (1): HDecLayer(
          (conv_tr): ConvTranspose1d(192, 96, kernel_size=(8,), stride=(4,))
          (norm2): Identity()
          (rewrite): Conv1d(192, 384, kernel_size=(3,), stride=(1,), padding=(1,))
          (norm1): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(192, 24, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 24, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(24, 384, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 384, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(192, 24, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 24, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(24, 384, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 384, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
        (2): HDecLayer(
          (conv_tr): ConvTranspose1d(96, 48, kernel_size=(8,), stride=(4,))
          (norm2): Identity()
          (rewrite): Conv1d(96, 192, kernel_size=(3,), stride=(1,), padding=(1,))
          (norm1): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(96, 12, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 12, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(12, 192, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 192, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(96, 12, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 12, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(12, 192, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 192, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
        (3): HDecLayer(
          (conv_tr): ConvTranspose1d(48, 8, kernel_size=(8,), stride=(4,))
          (norm2): Identity()
          (rewrite): Conv1d(48, 96, kernel_size=(3,), stride=(1,), padding=(1,))
          (norm1): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(48, 6, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 6, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(6, 96, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 96, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(48, 6, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 6, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(6, 96, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 96, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
      )
      (freq_emb): ScaledEmbedding(
        (embedding): Embedding(512, 48)
      )
      (channel_upsampler): Conv1d(384, 512, kernel_size=(1,), stride=(1,))
      (channel_downsampler): Conv1d(512, 384, kernel_size=(1,), stride=(1,))
      (channel_upsampler_t): Conv1d(384, 512, kernel_size=(1,), stride=(1,))
      (channel_downsampler_t): Conv1d(512, 384, kernel_size=(1,), stride=(1,))
      (crosstransformer): CrossTransformerEncoder(
        (norm_in): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (norm_in_t): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (layers): ModuleList(
          (0): MyTransformerEncoderLayer(
            (self_attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
            )
            (linear1): Linear(in_features=512, out_features=2048, bias=True)
            (dropout): Dropout(p=0.02, inplace=False)
            (linear2): Linear(in_features=2048, out_features=512, bias=True)
            (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (dropout1): Dropout(p=0.02, inplace=False)
            (dropout2): Dropout(p=0.02, inplace=False)
            (norm_out): MyGroupNorm(1, 512, eps=1e-05, affine=True)
            (gamma_1): LayerScale()
            (gamma_2): LayerScale()
          )
          (1): CrossTransformerEncoderLayer(
            (cross_attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
            )
            (linear1): Linear(in_features=512, out_features=2048, bias=True)
            (dropout): Dropout(p=0.02, inplace=False)
            (linear2): Linear(in_features=2048, out_features=512, bias=True)
            (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm3): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm_out): MyGroupNorm(1, 512, eps=1e-05, affine=True)
            (gamma_1): LayerScale()
            (gamma_2): LayerScale()
            (dropout1): Dropout(p=0.02, inplace=False)
            (dropout2): Dropout(p=0.02, inplace=False)
          )
          (2): MyTransformerEncoderLayer(
            (self_attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
            )
            (linear1): Linear(in_features=512, out_features=2048, bias=True)
            (dropout): Dropout(p=0.02, inplace=False)
            (linear2): Linear(in_features=2048, out_features=512, bias=True)
            (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (dropout1): Dropout(p=0.02, inplace=False)
            (dropout2): Dropout(p=0.02, inplace=False)
            (norm_out): MyGroupNorm(1, 512, eps=1e-05, affine=True)
            (gamma_1): LayerScale()
            (gamma_2): LayerScale()
          )
          (3): CrossTransformerEncoderLayer(
            (cross_attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
            )
            (linear1): Linear(in_features=512, out_features=2048, bias=True)
            (dropout): Dropout(p=0.02, inplace=False)
            (linear2): Linear(in_features=2048, out_features=512, bias=True)
            (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm3): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm_out): MyGroupNorm(1, 512, eps=1e-05, affine=True)
            (gamma_1): LayerScale()
            (gamma_2): LayerScale()
            (dropout1): Dropout(p=0.02, inplace=False)
            (dropout2): Dropout(p=0.02, inplace=False)
          )
          (4): MyTransformerEncoderLayer(
            (self_attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
            )
            (linear1): Linear(in_features=512, out_features=2048, bias=True)
            (dropout): Dropout(p=0.02, inplace=False)
            (linear2): Linear(in_features=2048, out_features=512, bias=True)
            (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (dropout1): Dropout(p=0.02, inplace=False)
            (dropout2): Dropout(p=0.02, inplace=False)
            (norm_out): MyGroupNorm(1, 512, eps=1e-05, affine=True)
            (gamma_1): LayerScale()
            (gamma_2): LayerScale()
          )
        )
        (layers_t): ModuleList(
          (0): MyTransformerEncoderLayer(
            (self_attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
            )
            (linear1): Linear(in_features=512, out_features=2048, bias=True)
            (dropout): Dropout(p=0.02, inplace=False)
            (linear2): Linear(in_features=2048, out_features=512, bias=True)
            (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (dropout1): Dropout(p=0.02, inplace=False)
            (dropout2): Dropout(p=0.02, inplace=False)
            (norm_out): MyGroupNorm(1, 512, eps=1e-05, affine=True)
            (gamma_1): LayerScale()
            (gamma_2): LayerScale()
          )
          (1): CrossTransformerEncoderLayer(
            (cross_attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
            )
            (linear1): Linear(in_features=512, out_features=2048, bias=True)
            (dropout): Dropout(p=0.02, inplace=False)
            (linear2): Linear(in_features=2048, out_features=512, bias=True)
            (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm3): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm_out): MyGroupNorm(1, 512, eps=1e-05, affine=True)
            (gamma_1): LayerScale()
            (gamma_2): LayerScale()
            (dropout1): Dropout(p=0.02, inplace=False)
            (dropout2): Dropout(p=0.02, inplace=False)
          )
          (2): MyTransformerEncoderLayer(
            (self_attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
            )
            (linear1): Linear(in_features=512, out_features=2048, bias=True)
            (dropout): Dropout(p=0.02, inplace=False)
            (linear2): Linear(in_features=2048, out_features=512, bias=True)
            (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (dropout1): Dropout(p=0.02, inplace=False)
            (dropout2): Dropout(p=0.02, inplace=False)
            (norm_out): MyGroupNorm(1, 512, eps=1e-05, affine=True)
            (gamma_1): LayerScale()
            (gamma_2): LayerScale()
          )
          (3): CrossTransformerEncoderLayer(
            (cross_attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
            )
            (linear1): Linear(in_features=512, out_features=2048, bias=True)
            (dropout): Dropout(p=0.02, inplace=False)
            (linear2): Linear(in_features=2048, out_features=512, bias=True)
            (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm3): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm_out): MyGroupNorm(1, 512, eps=1e-05, affine=True)
            (gamma_1): LayerScale()
            (gamma_2): LayerScale()
            (dropout1): Dropout(p=0.02, inplace=False)
            (dropout2): Dropout(p=0.02, inplace=False)
          )
          (4): MyTransformerEncoderLayer(
            (self_attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
            )
            (linear1): Linear(in_features=512, out_features=2048, bias=True)
            (dropout): Dropout(p=0.02, inplace=False)
            (linear2): Linear(in_features=2048, out_features=512, bias=True)
            (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (dropout1): Dropout(p=0.02, inplace=False)
            (dropout2): Dropout(p=0.02, inplace=False)
            (norm_out): MyGroupNorm(1, 512, eps=1e-05, affine=True)
            (gamma_1): LayerScale()
            (gamma_2): LayerScale()
          )
        )
      )
    )
  )
) * Debugger is active!
 * Debugger PIN: 129-088-411
 * Detected change in '/home/tong/apps/8_bit_music/advanced_api.py', reloading

✅ Advanced Audio Analyzer initialized successfully
🚀 Starting ADVANCED 8-bit Music Analyzer API...
🎛️ Features: Demucs source separation + lead stem selection
   Advanced analyzer loaded: AdvancedAudioAnalyzer
   Demucs model: BagOfModels
   Supported frequencies: 24
   Pentatonic frequencies: 13
   Supported formats: m4a, wav, mp3, aac, ogg, flac
   Max file size: 16MB

Available endpoints:
  POST /analyze - Advanced audio analysis with Demucs
  GET /info - Service information
  GET /progress - Progress tracking info
  GET /health - Health check

Starting server on http://localhost:5001
 * Restarting with stat
Loading Demucs model for source separation...
Advanced Audio Analyzer initialized with Demucs BagOfModels(
  (models): ModuleList(
    (0-3): 4 x HTDemucs(
      (encoder): ModuleList(
        (0): HEncLayer(
          (conv): Conv2d(4, 48, kernel_size=(8, 1), stride=(4, 1), padding=(2, 0))
          (norm1): Identity()
          (rewrite): Conv2d(48, 96, kernel_size=(1, 1), stride=(1, 1))
          (norm2): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(48, 6, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 6, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(6, 96, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 96, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(48, 6, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 6, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(6, 96, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 96, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
        (1): HEncLayer(
          (conv): Conv2d(48, 96, kernel_size=(8, 1), stride=(4, 1), padding=(2, 0))
          (norm1): Identity()
          (rewrite): Conv2d(96, 192, kernel_size=(1, 1), stride=(1, 1))
          (norm2): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(96, 12, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 12, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(12, 192, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 192, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(96, 12, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 12, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(12, 192, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 192, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
        (2): HEncLayer(
          (conv): Conv2d(96, 192, kernel_size=(8, 1), stride=(4, 1), padding=(2, 0))
          (norm1): Identity()
          (rewrite): Conv2d(192, 384, kernel_size=(1, 1), stride=(1, 1))
          (norm2): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(192, 24, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 24, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(24, 384, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 384, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(192, 24, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 24, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(24, 384, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 384, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
        (3): HEncLayer(
          (conv): Conv2d(192, 384, kernel_size=(8, 1), stride=(4, 1), padding=(2, 0))
          (norm1): Identity()
          (rewrite): Conv2d(384, 768, kernel_size=(1, 1), stride=(1, 1))
          (norm2): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(384, 48, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 48, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(48, 768, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 768, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(384, 48, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 48, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(48, 768, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 768, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
      )
      (decoder): ModuleList(
        (0): HDecLayer(
          (conv_tr): ConvTranspose2d(384, 192, kernel_size=(8, 1), stride=(4, 1))
          (norm2): Identity()
          (rewrite): Conv2d(384, 768, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
          (norm1): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(384, 48, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 48, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(48, 768, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 768, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(384, 48, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 48, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(48, 768, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 768, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
        (1): HDecLayer(
          (conv_tr): ConvTranspose2d(192, 96, kernel_size=(8, 1), stride=(4, 1))
          (norm2): Identity()
          (rewrite): Conv2d(192, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
          (norm1): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(192, 24, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 24, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(24, 384, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 384, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(192, 24, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 24, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(24, 384, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 384, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
        (2): HDecLayer(
          (conv_tr): ConvTranspose2d(96, 48, kernel_size=(8, 1), stride=(4, 1))
          (norm2): Identity()
          (rewrite): Conv2d(96, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
          (norm1): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(96, 12, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 12, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(12, 192, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 192, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(96, 12, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 12, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(12, 192, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 192, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
        (3): HDecLayer(
          (conv_tr): ConvTranspose2d(48, 16, kernel_size=(8, 1), stride=(4, 1))
          (norm2): Identity()
          (rewrite): Conv2d(48, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
          (norm1): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(48, 6, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 6, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(6, 96, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 96, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(48, 6, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 6, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(6, 96, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 96, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
      )
      (tencoder): ModuleList(
        (0): HEncLayer(
          (conv): Conv1d(2, 48, kernel_size=(8,), stride=(4,), padding=(2,))
          (norm1): Identity()
          (rewrite): Conv1d(48, 96, kernel_size=(1,), stride=(1,))
          (norm2): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(48, 6, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 6, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(6, 96, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 96, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(48, 6, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 6, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(6, 96, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 96, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
        (1): HEncLayer(
          (conv): Conv1d(48, 96, kernel_size=(8,), stride=(4,), padding=(2,))
          (norm1): Identity()
          (rewrite): Conv1d(96, 192, kernel_size=(1,), stride=(1,))
          (norm2): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(96, 12, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 12, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(12, 192, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 192, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(96, 12, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 12, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(12, 192, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 192, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
        (2): HEncLayer(
          (conv): Conv1d(96, 192, kernel_size=(8,), stride=(4,), padding=(2,))
          (norm1): Identity()
          (rewrite): Conv1d(192, 384, kernel_size=(1,), stride=(1,))
          (norm2): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(192, 24, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 24, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(24, 384, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 384, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(192, 24, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 24, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(24, 384, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 384, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
        (3): HEncLayer(
          (conv): Conv1d(192, 384, kernel_size=(8,), stride=(4,), padding=(2,))
          (norm1): Identity()
          (rewrite): Conv1d(384, 768, kernel_size=(1,), stride=(1,))
          (norm2): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(384, 48, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 48, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(48, 768, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 768, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(384, 48, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 48, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(48, 768, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 768, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
      )
      (tdecoder): ModuleList(
        (0): HDecLayer(
          (conv_tr): ConvTranspose1d(384, 192, kernel_size=(8,), stride=(4,))
          (norm2): Identity()
          (rewrite): Conv1d(384, 768, kernel_size=(3,), stride=(1,), padding=(1,))
          (norm1): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(384, 48, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 48, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(48, 768, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 768, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(384, 48, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 48, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(48, 768, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 768, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
        (1): HDecLayer(
          (conv_tr): ConvTranspose1d(192, 96, kernel_size=(8,), stride=(4,))
          (norm2): Identity()
          (rewrite): Conv1d(192, 384, kernel_size=(3,), stride=(1,), padding=(1,))
          (norm1): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(192, 24, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 24, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(24, 384, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 384, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(192, 24, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 24, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(24, 384, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 384, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
        (2): HDecLayer(
          (conv_tr): ConvTranspose1d(96, 48, kernel_size=(8,), stride=(4,))
          (norm2): Identity()
          (rewrite): Conv1d(96, 192, kernel_size=(3,), stride=(1,), padding=(1,))
          (norm1): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(96, 12, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 12, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(12, 192, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 192, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(96, 12, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 12, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(12, 192, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 192, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
        (3): HDecLayer(
          (conv_tr): ConvTranspose1d(48, 8, kernel_size=(8,), stride=(4,))
          (norm2): Identity()
          (rewrite): Conv1d(48, 96, kernel_size=(3,), stride=(1,), padding=(1,))
          (norm1): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(48, 6, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 6, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(6, 96, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 96, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(48, 6, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 6, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(6, 96, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 96, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
      )
      (freq_emb): ScaledEmbedding(
        (embedding): Embedding(512, 48)
      )
      (channel_upsampler): Conv1d(384, 512, kernel_size=(1,), stride=(1,))
      (channel_downsampler): Conv1d(512, 384, kernel_size=(1,), stride=(1,))
      (channel_upsampler_t): Conv1d(384, 512, kernel_size=(1,), stride=(1,))
      (channel_downsampler_t): Conv1d(512, 384, kernel_size=(1,), stride=(1,))
      (crosstransformer): CrossTransformerEncoder(
        (norm_in): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (norm_in_t): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (layers): ModuleList(
          (0): MyTransformerEncoderLayer(
            (self_attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
            )
            (linear1): Linear(in_features=512, out_features=2048, bias=True)
            (dropout): Dropout(p=0.02, inplace=False)
            (linear2): Linear(in_features=2048, out_features=512, bias=True)
            (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (dropout1): Dropout(p=0.02, inplace=False)
            (dropout2): Dropout(p=0.02, inplace=False)
            (norm_out): MyGroupNorm(1, 512, eps=1e-05, affine=True)
            (gamma_1): LayerScale()
            (gamma_2): LayerScale()
          )
          (1): CrossTransformerEncoderLayer(
            (cross_attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
            )
            (linear1): Linear(in_features=512, out_features=2048, bias=True)
            (dropout): Dropout(p=0.02, inplace=False)
            (linear2): Linear(in_features=2048, out_features=512, bias=True)
            (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm3): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm_out): MyGroupNorm(1, 512, eps=1e-05, affine=True)
            (gamma_1): LayerScale()
            (gamma_2): LayerScale()
            (dropout1): Dropout(p=0.02, inplace=False)
            (dropout2): Dropout(p=0.02, inplace=False)
          )
          (2): MyTransformerEncoderLayer(
            (self_attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
            )
            (linear1): Linear(in_features=512, out_features=2048, bias=True)
            (dropout): Dropout(p=0.02, inplace=False)
            (linear2): Linear(in_features=2048, out_features=512, bias=True)
            (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (dropout1): Dropout(p=0.02, inplace=False)
            (dropout2): Dropout(p=0.02, inplace=False)
            (norm_out): MyGroupNorm(1, 512, eps=1e-05, affine=True)
            (gamma_1): LayerScale()
            (gamma_2): LayerScale()
          )
          (3): CrossTransformerEncoderLayer(
            (cross_attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
            )
            (linear1): Linear(in_features=512, out_features=2048, bias=True)
            (dropout): Dropout(p=0.02, inplace=False)
            (linear2): Linear(in_features=2048, out_features=512, bias=True)
            (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm3): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm_out): MyGroupNorm(1, 512, eps=1e-05, affine=True)
            (gamma_1): LayerScale()
            (gamma_2): LayerScale()
            (dropout1): Dropout(p=0.02, inplace=False)
            (dropout2): Dropout(p=0.02, inplace=False)
          )
          (4): MyTransformerEncoderLayer(
            (self_attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
            )
            (linear1): Linear(in_features=512, out_features=2048, bias=True)
            (dropout): Dropout(p=0.02, inplace=False)
            (linear2): Linear(in_features=2048, out_features=512, bias=True)
            (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (dropout1): Dropout(p=0.02, inplace=False)
            (dropout2): Dropout(p=0.02, inplace=False)
            (norm_out): MyGroupNorm(1, 512, eps=1e-05, affine=True)
            (gamma_1): LayerScale()
            (gamma_2): LayerScale()
          )
        )
        (layers_t): ModuleList(
          (0): MyTransformerEncoderLayer(
            (self_attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
            )
            (linear1): Linear(in_features=512, out_features=2048, bias=True)
            (dropout): Dropout(p=0.02, inplace=False)
            (linear2): Linear(in_features=2048, out_features=512, bias=True)
            (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (dropout1): Dropout(p=0.02, inplace=False)
            (dropout2): Dropout(p=0.02, inplace=False)
            (norm_out): MyGroupNorm(1, 512, eps=1e-05, affine=True)
            (gamma_1): LayerScale()
            (gamma_2): LayerScale()
          )
          (1): CrossTransformerEncoderLayer(
            (cross_attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
            )
            (linear1): Linear(in_features=512, out_features=2048, bias=True)
            (dropout): Dropout(p=0.02, inplace=False)
            (linear2): Linear(in_features=2048, out_features=512, bias=True)
            (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm3): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm_out): MyGroupNorm(1, 512, eps=1e-05, affine=True)
            (gamma_1): LayerScale()
            (gamma_2): LayerScale()
            (dropout1): Dropout(p=0.02, inplace=False)
            (dropout2): Dropout(p=0.02, inplace=False)
          )
          (2): MyTransformerEncoderLayer(
            (self_attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
            )
            (linear1): Linear(in_features=512, out_features=2048, bias=True)
            (dropout): Dropout(p=0.02, inplace=False)
            (linear2): Linear(in_features=2048, out_features=512, bias=True)
            (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (dropout1): Dropout(p=0.02, inplace=False)
            (dropout2): Dropout(p=0.02, inplace=False)
            (norm_out): MyGroupNorm(1, 512, eps=1e-05, affine=True)
            (gamma_1): LayerScale()
            (gamma_2): LayerScale()
          )
          (3): CrossTransformerEncoderLayer(
            (cross_attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
            )
            (linear1): Linear(in_features=512, out_features=2048, bias=True)
            (dropout): Dropout(p=0.02, inplace=False)
            (linear2): Linear(in_features=2048, out_features=512, bias=True)
            (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm3): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm_out): MyGroupNorm(1, 512, eps=1e-05, affine=True)
            (gamma_1): LayerScale()
            (gamma_2): LayerScale()
            (dropout1): Dropout(p=0.02, inplace=False)
            (dropout2): Dropout(p=0.02, inplace=False)
          )
          (4): MyTransformerEncoderLayer(
            (self_attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
            )
            (linear1): Linear(in_features=512, out_features=2048, bias=True)
            (dropout): Dropout(p=0.02, inplace=False)
            (linear2): Linear(in_features=2048, out_features=512, bias=True)
            (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (dropout1): Dropout(p=0.02, inplace=False)
            (dropout2): Dropout(p=0.02, inplace=False)
            (norm_out): MyGroupNorm(1, 512, eps=1e-05, affine=True)
            (gamma_1): LayerScale()
            (gamma_2): LayerScale()
          )
        )
      )
    )
  )
) * Debugger is active!
 * Debugger PIN: 129-088-411
 * Detected change in '/home/tong/apps/8_bit_music/advanced_api.py', reloading

✅ Advanced Audio Analyzer initialized successfully
🚀 Starting ADVANCED 8-bit Music Analyzer API...
🎛️ Features: Demucs source separation + lead stem selection
   Advanced analyzer loaded: AdvancedAudioAnalyzer
   Demucs model: BagOfModels
   Supported frequencies: 24
   Pentatonic frequencies: 13
   Supported formats: m4a, mp3, flac, wav, ogg, aac
   Max file size: 16MB

Available endpoints:
  POST /analyze - Advanced audio analysis with Demucs
  GET /info - Service information
  GET /progress - Progress tracking info
  GET /health - Health check

Starting server on http://localhost:5001
 * Restarting with stat
Loading Demucs model for source separation...
Advanced Audio Analyzer initialized with Demucs BagOfModels(
  (models): ModuleList(
    (0-3): 4 x HTDemucs(
      (encoder): ModuleList(
        (0): HEncLayer(
          (conv): Conv2d(4, 48, kernel_size=(8, 1), stride=(4, 1), padding=(2, 0))
          (norm1): Identity()
          (rewrite): Conv2d(48, 96, kernel_size=(1, 1), stride=(1, 1))
          (norm2): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(48, 6, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 6, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(6, 96, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 96, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(48, 6, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 6, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(6, 96, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 96, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
        (1): HEncLayer(
          (conv): Conv2d(48, 96, kernel_size=(8, 1), stride=(4, 1), padding=(2, 0))
          (norm1): Identity()
          (rewrite): Conv2d(96, 192, kernel_size=(1, 1), stride=(1, 1))
          (norm2): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(96, 12, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 12, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(12, 192, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 192, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(96, 12, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 12, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(12, 192, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 192, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
        (2): HEncLayer(
          (conv): Conv2d(96, 192, kernel_size=(8, 1), stride=(4, 1), padding=(2, 0))
          (norm1): Identity()
          (rewrite): Conv2d(192, 384, kernel_size=(1, 1), stride=(1, 1))
          (norm2): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(192, 24, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 24, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(24, 384, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 384, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(192, 24, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 24, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(24, 384, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 384, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
        (3): HEncLayer(
          (conv): Conv2d(192, 384, kernel_size=(8, 1), stride=(4, 1), padding=(2, 0))
          (norm1): Identity()
          (rewrite): Conv2d(384, 768, kernel_size=(1, 1), stride=(1, 1))
          (norm2): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(384, 48, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 48, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(48, 768, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 768, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(384, 48, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 48, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(48, 768, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 768, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
      )
      (decoder): ModuleList(
        (0): HDecLayer(
          (conv_tr): ConvTranspose2d(384, 192, kernel_size=(8, 1), stride=(4, 1))
          (norm2): Identity()
          (rewrite): Conv2d(384, 768, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
          (norm1): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(384, 48, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 48, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(48, 768, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 768, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(384, 48, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 48, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(48, 768, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 768, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
        (1): HDecLayer(
          (conv_tr): ConvTranspose2d(192, 96, kernel_size=(8, 1), stride=(4, 1))
          (norm2): Identity()
          (rewrite): Conv2d(192, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
          (norm1): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(192, 24, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 24, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(24, 384, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 384, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(192, 24, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 24, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(24, 384, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 384, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
        (2): HDecLayer(
          (conv_tr): ConvTranspose2d(96, 48, kernel_size=(8, 1), stride=(4, 1))
          (norm2): Identity()
          (rewrite): Conv2d(96, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
          (norm1): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(96, 12, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 12, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(12, 192, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 192, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(96, 12, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 12, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(12, 192, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 192, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
        (3): HDecLayer(
          (conv_tr): ConvTranspose2d(48, 16, kernel_size=(8, 1), stride=(4, 1))
          (norm2): Identity()
          (rewrite): Conv2d(48, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
          (norm1): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(48, 6, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 6, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(6, 96, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 96, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(48, 6, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 6, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(6, 96, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 96, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
      )
      (tencoder): ModuleList(
        (0): HEncLayer(
          (conv): Conv1d(2, 48, kernel_size=(8,), stride=(4,), padding=(2,))
          (norm1): Identity()
          (rewrite): Conv1d(48, 96, kernel_size=(1,), stride=(1,))
          (norm2): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(48, 6, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 6, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(6, 96, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 96, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(48, 6, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 6, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(6, 96, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 96, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
        (1): HEncLayer(
          (conv): Conv1d(48, 96, kernel_size=(8,), stride=(4,), padding=(2,))
          (norm1): Identity()
          (rewrite): Conv1d(96, 192, kernel_size=(1,), stride=(1,))
          (norm2): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(96, 12, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 12, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(12, 192, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 192, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(96, 12, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 12, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(12, 192, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 192, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
        (2): HEncLayer(
          (conv): Conv1d(96, 192, kernel_size=(8,), stride=(4,), padding=(2,))
          (norm1): Identity()
          (rewrite): Conv1d(192, 384, kernel_size=(1,), stride=(1,))
          (norm2): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(192, 24, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 24, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(24, 384, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 384, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(192, 24, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 24, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(24, 384, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 384, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
        (3): HEncLayer(
          (conv): Conv1d(192, 384, kernel_size=(8,), stride=(4,), padding=(2,))
          (norm1): Identity()
          (rewrite): Conv1d(384, 768, kernel_size=(1,), stride=(1,))
          (norm2): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(384, 48, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 48, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(48, 768, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 768, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(384, 48, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 48, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(48, 768, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 768, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
      )
      (tdecoder): ModuleList(
        (0): HDecLayer(
          (conv_tr): ConvTranspose1d(384, 192, kernel_size=(8,), stride=(4,))
          (norm2): Identity()
          (rewrite): Conv1d(384, 768, kernel_size=(3,), stride=(1,), padding=(1,))
          (norm1): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(384, 48, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 48, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(48, 768, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 768, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(384, 48, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 48, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(48, 768, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 768, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
        (1): HDecLayer(
          (conv_tr): ConvTranspose1d(192, 96, kernel_size=(8,), stride=(4,))
          (norm2): Identity()
          (rewrite): Conv1d(192, 384, kernel_size=(3,), stride=(1,), padding=(1,))
          (norm1): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(192, 24, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 24, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(24, 384, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 384, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(192, 24, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 24, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(24, 384, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 384, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
        (2): HDecLayer(
          (conv_tr): ConvTranspose1d(96, 48, kernel_size=(8,), stride=(4,))
          (norm2): Identity()
          (rewrite): Conv1d(96, 192, kernel_size=(3,), stride=(1,), padding=(1,))
          (norm1): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(96, 12, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 12, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(12, 192, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 192, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(96, 12, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 12, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(12, 192, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 192, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
        (3): HDecLayer(
          (conv_tr): ConvTranspose1d(48, 8, kernel_size=(8,), stride=(4,))
          (norm2): Identity()
          (rewrite): Conv1d(48, 96, kernel_size=(3,), stride=(1,), padding=(1,))
          (norm1): Identity()
          (dconv): DConv(
            (layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(48, 6, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GroupNorm(1, 6, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(6, 96, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 96, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
              (1): Sequential(
                (0): Conv1d(48, 6, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
                (1): GroupNorm(1, 6, eps=1e-05, affine=True)
                (2): GELU(approximate='none')
                (3): Conv1d(6, 96, kernel_size=(1,), stride=(1,))
                (4): GroupNorm(1, 96, eps=1e-05, affine=True)
                (5): GLU(dim=1)
                (6): LayerScale()
              )
            )
          )
        )
      )
      (freq_emb): ScaledEmbedding(
        (embedding): Embedding(512, 48)
      )
      (channel_upsampler): Conv1d(384, 512, kernel_size=(1,), stride=(1,))
      (channel_downsampler): Conv1d(512, 384, kernel_size=(1,), stride=(1,))
      (channel_upsampler_t): Conv1d(384, 512, kernel_size=(1,), stride=(1,))
      (channel_downsampler_t): Conv1d(512, 384, kernel_size=(1,), stride=(1,))
      (crosstransformer): CrossTransformerEncoder(
        (norm_in): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (norm_in_t): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (layers): ModuleList(
          (0): MyTransformerEncoderLayer(
            (self_attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
            )
            (linear1): Linear(in_features=512, out_features=2048, bias=True)
            (dropout): Dropout(p=0.02, inplace=False)
            (linear2): Linear(in_features=2048, out_features=512, bias=True)
            (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (dropout1): Dropout(p=0.02, inplace=False)
            (dropout2): Dropout(p=0.02, inplace=False)
            (norm_out): MyGroupNorm(1, 512, eps=1e-05, affine=True)
            (gamma_1): LayerScale()
            (gamma_2): LayerScale()
          )
          (1): CrossTransformerEncoderLayer(
            (cross_attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
            )
            (linear1): Linear(in_features=512, out_features=2048, bias=True)
            (dropout): Dropout(p=0.02, inplace=False)
            (linear2): Linear(in_features=2048, out_features=512, bias=True)
            (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm3): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm_out): MyGroupNorm(1, 512, eps=1e-05, affine=True)
            (gamma_1): LayerScale()
            (gamma_2): LayerScale()
            (dropout1): Dropout(p=0.02, inplace=False)
            (dropout2): Dropout(p=0.02, inplace=False)
          )
          (2): MyTransformerEncoderLayer(
            (self_attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
            )
            (linear1): Linear(in_features=512, out_features=2048, bias=True)
            (dropout): Dropout(p=0.02, inplace=False)
            (linear2): Linear(in_features=2048, out_features=512, bias=True)
            (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (dropout1): Dropout(p=0.02, inplace=False)
            (dropout2): Dropout(p=0.02, inplace=False)
            (norm_out): MyGroupNorm(1, 512, eps=1e-05, affine=True)
            (gamma_1): LayerScale()
            (gamma_2): LayerScale()
          )
          (3): CrossTransformerEncoderLayer(
            (cross_attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
            )
            (linear1): Linear(in_features=512, out_features=2048, bias=True)
            (dropout): Dropout(p=0.02, inplace=False)
            (linear2): Linear(in_features=2048, out_features=512, bias=True)
            (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm3): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm_out): MyGroupNorm(1, 512, eps=1e-05, affine=True)
            (gamma_1): LayerScale()
            (gamma_2): LayerScale()
            (dropout1): Dropout(p=0.02, inplace=False)
            (dropout2): Dropout(p=0.02, inplace=False)
          )
          (4): MyTransformerEncoderLayer(
            (self_attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
            )
            (linear1): Linear(in_features=512, out_features=2048, bias=True)
            (dropout): Dropout(p=0.02, inplace=False)
            (linear2): Linear(in_features=2048, out_features=512, bias=True)
            (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (dropout1): Dropout(p=0.02, inplace=False)
            (dropout2): Dropout(p=0.02, inplace=False)
            (norm_out): MyGroupNorm(1, 512, eps=1e-05, affine=True)
            (gamma_1): LayerScale()
            (gamma_2): LayerScale()
          )
        )
        (layers_t): ModuleList(
          (0): MyTransformerEncoderLayer(
            (self_attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
            )
            (linear1): Linear(in_features=512, out_features=2048, bias=True)
            (dropout): Dropout(p=0.02, inplace=False)
            (linear2): Linear(in_features=2048, out_features=512, bias=True)
            (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (dropout1): Dropout(p=0.02, inplace=False)
            (dropout2): Dropout(p=0.02, inplace=False)
            (norm_out): MyGroupNorm(1, 512, eps=1e-05, affine=True)
            (gamma_1): LayerScale()
            (gamma_2): LayerScale()
          )
          (1): CrossTransformerEncoderLayer(
            (cross_attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
            )
            (linear1): Linear(in_features=512, out_features=2048, bias=True)
            (dropout): Dropout(p=0.02, inplace=False)
            (linear2): Linear(in_features=2048, out_features=512, bias=True)
            (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm3): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm_out): MyGroupNorm(1, 512, eps=1e-05, affine=True)
            (gamma_1): LayerScale()
            (gamma_2): LayerScale()
            (dropout1): Dropout(p=0.02, inplace=False)
            (dropout2): Dropout(p=0.02, inplace=False)
          )
          (2): MyTransformerEncoderLayer(
            (self_attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
            )
            (linear1): Linear(in_features=512, out_features=2048, bias=True)
            (dropout): Dropout(p=0.02, inplace=False)
            (linear2): Linear(in_features=2048, out_features=512, bias=True)
            (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (dropout1): Dropout(p=0.02, inplace=False)
            (dropout2): Dropout(p=0.02, inplace=False)
            (norm_out): MyGroupNorm(1, 512, eps=1e-05, affine=True)
            (gamma_1): LayerScale()
            (gamma_2): LayerScale()
          )
          (3): CrossTransformerEncoderLayer(
            (cross_attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
            )
            (linear1): Linear(in_features=512, out_features=2048, bias=True)
            (dropout): Dropout(p=0.02, inplace=False)
            (linear2): Linear(in_features=2048, out_features=512, bias=True)
            (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm3): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm_out): MyGroupNorm(1, 512, eps=1e-05, affine=True)
            (gamma_1): LayerScale()
            (gamma_2): LayerScale()
            (dropout1): Dropout(p=0.02, inplace=False)
            (dropout2): Dropout(p=0.02, inplace=False)
          )
          (4): MyTransformerEncoderLayer(
            (self_attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
            )
            (linear1): Linear(in_features=512, out_features=2048, bias=True)
            (dropout): Dropout(p=0.02, inplace=False)
            (linear2): Linear(in_features=2048, out_features=512, bias=True)
            (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (dropout1): Dropout(p=0.02, inplace=False)
            (dropout2): Dropout(p=0.02, inplace=False)
            (norm_out): MyGroupNorm(1, 512, eps=1e-05, affine=True)
            (gamma_1): LayerScale()
            (gamma_2): LayerScale()
          )
        )
      )
    )
  )
) * Debugger is active!
 * Debugger PIN: 129-088-411
